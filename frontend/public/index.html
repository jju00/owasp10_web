<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>BlackCat Security</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="BlackCat SecurityëŠ” ì¹¨í•´ì‚¬ê³  ëŒ€ì‘, ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤, ë³´ì•ˆ ì»¨ì„¤íŒ… ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.">
  <link rel="stylesheet" href="/frontend/public/assets/css/style.css" />
</head>

<body id="top">
  <!-- í—¤ë” -->
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="#top" aria-label="BlackCat Security">
        <img src="/frontend/public/assets/img/dark-logo.png" alt="" />
        <span class="brand-text">BlackCat Security</span>
      </a>

      <nav class="nav" aria-label="ì£¼ìš” ë©”ë‰´">
        <button class="nav-toggle" aria-expanded="false" aria-controls="navMenu">Menu</button>
        <ul id="navMenu" class="nav-menu">
          <!-- ë“œë¡­ë‹¤ìš´: HOME -->
          <li class="has-sub">
            <a class="toplink" href="#top"> 
              HOME<span class="arrow"> </span></a>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: ABOUT -->
          <li class="has-sub">
            <a class="toplink" href="#about">
              ABOUT <span class="arrow"> </span></a>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: ACTIVITY -->
          <li class="has-sub">
            <a class="toplink" href="#activities">
              ACTIVITY <span class="arrow">â–¼</span></a>
            <ul class="submenu">
              <li><a href="#activities">Study</a></li>
              <li><a href="#activities">Conference</a></li>
              <li><a href="#activities">CTF</a></li>
              <li><a href="#activities">Project</a></li>
            </ul>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: BOARD -->
          <li class="has-sub">
            <a class="toplink" href="/board">
              BOARD <span class="arrow"></span></a>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: login -->
          <li class="has-sub">
            <a class="toplink" id="loginMenu" href="#login">
              LOGIN <span class="arrow">â–¼</span></a>
            <ul class="submenu">
              <li><a href="/login">Login</a></li>
              <li><a href="#">Sign Up</a></li>
              <li><a href="#">Forgotten ID / PW</a></li>
            </ul>
          </li>
        </ul>
      </nav>

      <!-- í—¤ë” ì•„ì´ì½˜ -->
      <div class="header-actions" role="group" aria-label="ì‚¬ìš©ì/ê²€ìƒ‰/ì–¸ì–´">
        <a class="icon-btn" id="personBtn" href="/login" aria-label="ë¡œê·¸ì¸">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true"><path fill="currentColor" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z"/></svg>
        </a>
        <span class="vdiv" aria-hidden="true"></span>
        <button class="icon-btn" type="button" aria-label="ê²€ìƒ‰">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true"><path fill="currentColor" d="M21 20.29 16.65 16a8 8 0 1 0-1.41 1.41L20.29 21 21 20.29ZM4 10a6 6 0 1 1 6 6 6 6 0 0 1-6-6Z"/></svg>
        </button>
      </div>
    </div>
  </header>

  <!-- íˆì–´ë¡œ -->
  <section class="hero">
    <div class="container hero-inner">
      <h1 class="hero-title">Learn. Build. Grow.</h1>
      <p class="hero-sub strong">A community where we grow together through security and technology.</p>
    </div>
  </section>

  <!-- ABOUT US ì„¹ì…˜ -->
  <section id="about" class="slice-about slice-dark">
    <div class="container activities-wrap">
      <h2 class="about-heading">ABOUT US</h2>
        <div class="feature-shelf">
          <div class="feature-grid">
            <article class="feature-card">
              <!-- ê²½ë¡œ í†µì¼ í•„ìš” ì‹œ ì¡°ì • -->
              <img class="profile-icon" src="/frontend/public/assets/img/bob.png" alt="" width="120" height="120" loading="lazy" />
              <h3>Bob</h3>
              <p class="feature-desc">
                President<br>
                Leading the club with a passion for security, collaboration, and growth.<br><br>
                <em>â€œLetâ€™s build something meaningful together.â€</em>
              </p>
            </article>

            <article class="feature-card">
              <img class="profile-icon" src="/frontend/public/assets/img/alice.png" alt="" width="84" height="84" loading="lazy" />
              <h3>Alice</h3>
              <p class="feature-desc">
                Vice President<br>
                Supporting the team and keeping everything running smoothly.<br><br>
                <em>â€œIâ€™ll make sure no one gets left behind.â€</em>
              </p>
            </article>

            <article class="feature-card">
              <img class="profile-icon" src="/frontend/public/assets/img/charlie.png" alt="" width="84" height="84" loading="lazy" />
              <h3>Charlie</h3>
              <p class="feature-desc">
                Treasurer<br>
                Managing resources and keeping the club organized and efficient.<br><br>
                <em>â€œIâ€™ll make every effort count.â€</em>
              </p>
            </article>

            <article class="feature-card">
              <img class="profile-icon" src="/frontend/public/assets/img/diana.png" alt="" width="84" height="84" loading="lazy" />
              <h3>Diana</h3>
              <p class="feature-desc">
                PR & Planning<br>
                Connecting ideas, people, and events to grow our community.<br><br>
                <em>â€œLetâ€™s make our activities visible and memorable.â€</em>
              </p>
            </article>

            <article class="feature-card">
              <img class="profile-icon" src="/frontend/public/assets/img/richard.png" alt="" width="84" height="84" loading="lazy" />
              <h3>Richard</h3>
              <p class="feature-desc">
                Faculty Advisor<br>
                Guiding and supporting the club with experience and insight.<br><br>
                <em>â€œIâ€™ll be here to support your growth and challenges.â€</em>
              </p>
            </article>
          </div>
      </div>
    </div>
  </section>

  <!-- ACTIVITIES ì„¹ì…˜ -->
  <section id="activities" class="slice-dark">
    <div class="container activities-wrap">
      <h2 class="activities-heading">ACTIVITIES</h2>
        <div class="feature-shelf">
          <div class="feature-grid">
            <article class="feature-card">
              <!-- ê²½ë¡œ í†µì¼ í•„ìš” ì‹œ ì¡°ì • -->
              <img class="feature-icon" src="/frontend/public/assets/img/study.png" alt="" width="84" height="84" loading="lazy" />
              <h3>STUDY & SEMINAR</h3>
              <p class="feature-desc">
                Enhancing <br>
                fundamental hacking abilities <br>
                via a self-paced study group, <br>
                followed by seminar<br>
                presentations based on<br>
                the knowledge acquired.
              </p>
            </article>

            <article class="feature-card">
              <img class="feature-icon" src="/frontend/public/assets/img/winner.png" alt="" width="84" height="84" loading="lazy" />
              <h3>CTF</h3>
              <p class="feature-desc">
                Participating as a group<br>
                in various conferences<br>
                and CTF competitions.<br>
              </p>
            </article>

            <article class="feature-card">
              <img class="feature-icon" src="/frontend/public/assets/img/project.png" alt="" width="84" height="84" loading="lazy" />
              <h3>PROJECTS</h3>
              <p class="feature-desc">
                Conducting security projects <br>
                in diverse fields such as <br>
                embedded systems, web, and <br>
                pwnable, and reinforcing learning <br>
                through documentation.
              </p>
            </article>
          </div>
      </div>
    </div>
  </section>

  <!-- BOARD ì„¹ì…˜ (ìŠ¬ë¼ì´ë“œ + ê²Œì‹œíŒ/ì•„ì´ì½˜) -->
  <section id="board" class="slice-board">
    <div class="container">
      <!-- ìƒë‹¨ í° íƒ€ì´í‹€ -->
      <h2 class="board-heading">EVENT OF THIS MONTH</h2>

      <!-- ë°°ë„ˆ ì´ë¯¸ì§€ ì˜ì—­ -->
      <div class="banner-image" style="margin-top: 2rem;">
        <img id="banner-img" src="" alt="ì´ë²ˆ ë‹¬ ì´ë²¤íŠ¸ ë°°ë„ˆ" style="
          display: block;
          margin: 0 auto;
          max-height: 600px;
          border-radius: 16px;
          box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        " />
      </div>

      <script>
        fetch('/banner')
          .then(res => res.json())
          .then(data => {
            const img = document.getElementById('banner-img');
            if (data.url) {
              // ì ˆëŒ€ URLì„ ìƒëŒ€ ê²½ë¡œë¡œ ë³€í™˜
              const relativeUrl = new URL(data.url, window.location.origin).pathname;
              img.src = relativeUrl;
            } else {
              img.alt = 'Banner image not selected.';
            }
          })
          .catch(err => {
            console.error('Failed to load banner image:', err);
          });
      </script>

      <!-- í•˜ë‹¨ 2ë‹¨ ê·¸ë¦¬ë“œ: ì™¼ìª½ ê²Œì‹œíŒ / ì˜¤ë¥¸ìª½ ì•ˆë‚´+ì•„ì´ì½˜ -->
      <div class="board-grid">
        <!-- ì™¼ìª½: ê²Œì‹œíŒ -->
        <section class="panel board-panel" id="board-list" aria-labelledby="noticeTab">
          <div class="tabs">
            <button id="tabAll" class="tab is-active" data-cat="all">ALL</button>
            <button class="tab" data-cat="NOTICE">NOTICE</button>
            <button class="tab" data-cat="EVENT">EVENT</button>
            <button class="tab" data-cat="SECRET">SECRET</button>
            <button class="tab" data-cat="PROMOTION">PROMOTION</button>
            <button class="tab add" aria-label="ê²Œì‹œ ì¶”ê°€">ï¼‹</button>
          </div>
          <ul class="board-list" id="boardList">
            <!-- JavaScriptë¡œ ë™ì  ë¡œë“œ -->
          </ul>
          <a class="more" href="/board">more</a>
        </section>

        <!-- ì˜¤ë¥¸ìª½: ì•ˆë‚´ ë°•ìŠ¤ + ì•„ì´ì½˜ -->
        <aside class="panel info-panel">
          <div class="info-card">
            <h3 class="info-title">Concact US</h3>
            <p class="info-copy">
              Please Send Email to Connect Us
            </p>

            <!-- Email ë²„íŠ¼ -->
            <div class="email-card">
              <div class="email-icon">
                <img src="/frontend/public/assets/img/email.png" alt="Email" />
              </div>
              <div class="email-text">
                <strong>Email</strong>
                <span>nagox76@gmail.com</span>
              </div>
            </div>
          </div>

          <!-- ì•„ì´ì½˜ë“¤ -->
          <div class="sns-bar">
            <h4 class="sns-title">More About BlackCat</h4>
            <div class="sns-icons">
              <!-- ì‹¤ì œ ì•„ì´ì½˜ íŒŒì¼ì´ ìˆìœ¼ë©´ imgë¡œ êµì²´ ê°€ëŠ¥ -->
              <a class="sns yt" href="#" aria-label="YouTube">â–¶</a>
              <a class="sns fb" href="#" aria-label="Facebook">f</a>
              <a class="sns x"  href="#" aria-label="X">x</a>
              <a class="sns blog" href="#" aria-label="Blog">b</a>
              <a class="sns ig" href="#" aria-label="Instagram">â—</a>
              <a class="sns gh" href="#" aria-label="GitHub">ğŸ±</a>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <!-- í‘¸í„° -->
  <footer id="contact" class="site-footer">
    <div class="container footer-inner">
      <div>
        <strong>BlackCat Security</strong><br/>
        security@blackcat.security
      </div>
    </div>
    <p class="copy">Â© 2025 BlackCat Security. All rights reserved.</p>
  </footer>

  <pre id="lfiPath"></pre>
  <iframe id="lfiFrame" style="width:100%;height:200px;"></iframe>


  <!-- js ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    // ëª¨ë°”ì¼ í† ê¸€ & ì ‘ê·¼ì„±
    const navToggle = document.querySelector('.nav-toggle');
    const navMenu = document.getElementById('navMenu');
    navToggle?.addEventListener('click', () => {
      const open = navMenu.classList.toggle('open');
      navToggle.setAttribute('aria-expanded', String(open));
    });
    // ë“œë¡­ë‹¤ìš´ í† ê¸€(í‚¤ë³´ë“œ ì ‘ê·¼)
    document.querySelectorAll('.has-sub > .toplink').forEach(btn=>{
      if (btn.tagName !== 'BUTTON') return;
      const submenu = btn.nextElementSibling;
      btn.addEventListener('click', ()=>{
        e.preventDefault();
        const open = submenu.classList.toggle('open');
        btn.setAttribute('aria-expanded', String(open));
      });
    });
  </script>

  <script>
  (() => {
    const el = document.querySelector('.slice-dark .grow-only');
    if (!el) return;

    const fromScale = 0.94;
    const toScale   = 1.30;
    const enterAt   = 0.98;
    const exitAt    = -1.15;

    let ticking = false;
    const clamp = (v,min,max)=> Math.max(min, Math.min(max, v));
    const easeOutCubic = t => 1 - Math.pow(1 - t, 3);

    function update(){
      ticking = false;
      const rect = el.getBoundingClientRect();
      const vh = window.innerHeight;
      const topRatio = rect.top / vh;

      let t = (enterAt - topRatio) / (enterAt - exitAt);
      t = clamp(t, 0, 1);
      t = easeOutCubic(t);

      const s = fromScale + (toScale - fromScale) * t;
      el.style.transform = `scale(${s})`;
      el.style.opacity   = String(0.95 + 0.05 * t);
    }

    const io = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if (entry.isIntersecting){
          onScroll();
          window.addEventListener('scroll', onScroll, {passive:true});
        }else{
          window.removeEventListener('scroll', onScroll);
        }
      });
    }, {threshold: [0,1]});

    function onScroll(){
      if (!ticking){
        ticking = true;
        requestAnimationFrame(update);
      }
    }

    io.observe(el);
    window.addEventListener('resize', onScroll);
  })();
  </script>

  <script>
  (() => {
    const root = document.querySelector('.carousel');
    if (!root) return;

    const track = root.querySelector('.track');
    const slides = Array.from(root.querySelectorAll('.slide'));
    const prevBtn = root.querySelector('.prev');
    const nextBtn = root.querySelector('.next');
    const dots = Array.from(root.querySelectorAll('.dot'));
    const pauseBtn = root.querySelector('.pause');
    const viewport = root.querySelector('.viewport');

    let index = 0;
    const last = slides.length - 1;
    const intervalMs = 4500;
    let timer = null;
    let isPaused = false;

    function go(i){
      index = (i + slides.length) % slides.length;
      const offset = -index * 100;
      track.style.transform = `translateX(${offset}%)`;
      slides.forEach((s,idx)=> s.classList.toggle('is-active', idx === index));
      dots.forEach((d,idx)=>{
        d.classList.toggle('is-active', idx === index);
        d.setAttribute('aria-selected', idx===index ? 'true' : 'false');
        d.tabIndex = idx===index ? 0 : -1;
      });
    }

    function next(){ go(index + 1); }
    function prev(){ go(index - 1); }

    function start(){
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      stop(); timer = setInterval(next, intervalMs);
    }
    function stop(){ if (timer){ clearInterval(timer); timer = null; } }

    nextBtn.addEventListener('click', ()=>{ next(); start(); });
    prevBtn.addEventListener('click', ()=>{ prev(); start(); });
    dots.forEach((d,idx)=> d.addEventListener('click', ()=>{ go(idx); start(); }));

    pauseBtn.addEventListener('click', ()=>{
      isPaused = !isPaused;
      if (isPaused){ stop(); pauseBtn.textContent = 'â–¶'; pauseBtn.title = 'ì¬ìƒ'; }
      else { start(); pauseBtn.textContent = 'âšâš'; pauseBtn.title = 'ì¼ì‹œì •ì§€'; }
    });

    ['mouseenter','focusin'].forEach(ev => root.addEventListener(ev, ()=>{ stop(); }));
    ['mouseleave','focusout'].forEach(ev => root.addEventListener(ev, ()=>{ if(!isPaused) start(); }));

    viewport.addEventListener('keydown', (e)=>{
      if (e.key === 'ArrowRight'){ next(); start(); }
      if (e.key === 'ArrowLeft'){ prev(); start(); }
    });

    let startX = 0;
    viewport.addEventListener('touchstart', e => startX = e.touches[0].clientX, {passive:true});
    viewport.addEventListener('touchend', e => {
      const dx = e.changedTouches[0].clientX - startX;
      if (Math.abs(dx) > 40){ dx < 0 ? next() : prev(); start(); }
    }, {passive:true});

    document.addEventListener('visibilitychange', ()=> {
      if (document.hidden) stop(); else if (!isPaused) start();
    });

    go(0); start();
  })();
  </script>

  <!-- ê²Œì‹œíŒ ë¯¸ë¦¬ë³´ê¸° ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸ -->
  <script src="/frontend/public/assets/js/auth.js"></script>
  
  <!-- ë¡œê·¸ì¸ ì²´í¬: í† í°ì´ ì—†ìœ¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ -->
  <script>
  (() => {
    // auth.jsê°€ ë¡œë“œëœ í›„ í† í° ì²´í¬
    const token = window.getToken && window.getToken();
    if (!token) {
      // í† í°ì´ ì—†ìœ¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      alert('Login is required.');
      location.href = '/login';
    }
  })();

  // í† í° íŒŒì‹±í•¨ìˆ˜ (ì‚¬ìš©ì í™•ì¸ìš©)
  function parseJwt(token) {
    try {
      return JSON.parse(atob(token.split('.')[1]));
    } catch (e) {
      return null;
    }
  }

  function getCurrentUsername() {
    const token = window.getToken && window.getToken();
    if (!token) return null;
    const payload = parseJwt(token);
    return payload?.username || null;
  }
  </script>

  <script>
  (() => {
    const boardList = document.getElementById('boardList');
    const tabButtons = document.querySelectorAll('.board-panel .tab[data-cat]');
    
    let allPosts = [];
    let currentCategory = 'all';

    // ë‚ ì§œ í¬ë§· í•¨ìˆ˜
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${month}-${day}`;
    }

    // ê²Œì‹œíŒ ë Œë”ë§ í•¨ìˆ˜
    function renderBoard(category) {
      currentCategory = category;
      
      // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
      let filteredPosts = (category === 'all' 
        ? allPosts 
        : allPosts.filter(post => post.cat === category)
      ).filter(post => post.id !== 0); //0ë²ˆ ê¸€ì€ í‘œì‹œ ì•ˆí•¨.

      // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ë¡œë“œ
      const currentUsername = getCurrentUsername();

      // ìµœì‹  4ê°œë§Œ í‘œì‹œ
      filteredPosts = filteredPosts.slice(0, 4);

      // HTML ìƒì„±
      if (filteredPosts.length === 0) {
        boardList.innerHTML = '<li style="padding: 20px; text-align: center; color: #999;">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</li>';
        return;
      }
      
      boardList.innerHTML = filteredPosts.map(post => {
        const isPrivate = post.cat === 'SECRET' && currentUsername && post.author !== currentUsername;
        const link = isPrivate ? '/post/0' : `/post/${post.id}`;
        return `  
          <li>
            <a href="${link}">${post.title}</a>
            <time>${formatDate(post.date)}</time>
          </li>
        `;
      }).join('');
    }

    // íƒ­ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    tabButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        // í™œì„±í™” ìƒíƒœ ë³€ê²½
        tabButtons.forEach(b => b.classList.remove('is-active'));
        btn.classList.add('is-active');
        
        // ê²Œì‹œíŒ ë Œë”ë§
        renderBoard(btn.dataset.cat);
      });
    });

    // ê²Œì‹œíŒ ë°ì´í„° ë¡œë“œ
    async function loadBoardData() {
      try {
        const response = await fetch('/api/board');
        if (!response.ok) {
          throw new Error('ê²Œì‹œíŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
        
        const data = await response.json();
        allPosts = data;
        
        // ì´ˆê¸° ë Œë”ë§ (ì „ì²´ ë³´ê¸°)
        renderBoard('all');
      } catch (error) {
        console.error('ê²Œì‹œíŒ ë¡œë“œ ì˜¤ë¥˜:', error);
        boardList.innerHTML = '<li style="padding: 20px; text-align: center; color: #e66;">Failed to load Board.</li>';
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²Œì‹œíŒ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    loadBoardData();
  })();
  </script>

  <!-- ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ GNB ê°±ì‹  -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const loginMenu = document.getElementById('loginMenu');          // <a id="loginMenu">LOGIN â–¼</a>
    const personBtn = document.getElementById('personBtn');
    const loginLi   = loginMenu?.closest('li.has-sub');              // <li class="has-sub"> ... </li>
    const submenu   = loginLi?.querySelector('.submenu');            // ë“œë¡­ë‹¤ìš´ UL
    const arrow     = loginMenu?.querySelector('.arrow');            // â–¼ ì•„ì´ì½˜ span

    const hasToken = !!(window.getToken && window.getToken());

    if (hasToken) {
      // 1) ìƒë‹¨ í…ìŠ¤íŠ¸/ë™ì‘ì„ LOGOUTìœ¼ë¡œ ì „í™˜
      loginMenu.textContent = 'LOGOUT';
      loginMenu.href = '#';
      loginMenu.addEventListener('click', (e) => {
        e.preventDefault();
        clearToken();
        alert('You have been logged out.');
        location.href = '/';
      }, { once: true });

      // 2) ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ì œê±° (ë¡œê·¸ì¸/íšŒì›ê°€ì…/ì•„ì´ë””ì°¾ê¸° ìˆ¨ê¹€)
      if (submenu) submenu.remove();
      // ë“œë¡­ë‹¤ìš´ ì¼€ëŸ¿/ìŠ¤íƒ€ì¼ ì œê±°
      arrow?.remove();
      loginLi?.classList.remove('has-sub');

      // 3) ì‚¬ëŒ ì•„ì´ì½˜ì€ ë§ˆì´í˜ì´ì§€ë¡œ
      personBtn?.setAttribute('href','/profile/me');
    } else {
      // ë¹„ë¡œê·¸ì¸: ê¸°ë³¸ ë§í¬ ìœ ì§€
      loginMenu?.setAttribute('href','/login');
      personBtn?.setAttribute('href','/login');
    }
  });
  </script>


</body>
</html>
