<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>BlackCat Security | posts </title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/frontend/public/assets/css/style.css" />
  <link rel="stylesheet" href="/frontend/public/assets/css/post.css" />
</head>

<body id="top">
  <!-- gnb - index.html과 같음 -->
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="#top" aria-label="BlackCat Security">
        <img src="/frontend/public/assets/img/dark-logo.png" alt="" />
        <span class="brand-text">BlackCat Security</span>
      </a>

      <nav class="nav" aria-label="주요 메뉴">
        <button class="nav-toggle" aria-expanded="false" aria-controls="navMenu">메뉴</button>
        <ul id="navMenu" class="nav-menu">
          <!-- 드롭다운: HOME -->
          <li class="has-sub">
            <a class="toplink" href="/frontend/public/index.html#top">
              HOME<span class="arrow"> </span>
            </a>
          </li>

          <!-- 드롭다운: ABOUT -->
          <li class="has-sub">
            <a class="toplink" href="/frontend/public/index.html#about">
              ABOUT <span class="arrow"> </span>
            </a>
          </li>

          <!-- 드롭다운: ACTIVITY -->
          <li class="has-sub">
            <a class="toplink" href="/frontend/public/index.html#activities">
              ACTIVITY <span class="arrow">▼</span>
            </a>
            <ul class="submenu">
              <li><a href="/frontend/public/index.html#activities">스터디</a></li>
              <li><a href="/frontend/public/index.html#activities">컨퍼런스</a></li>
              <li><a href="/frontend/public/index.html#activities">ctf</a></li>
              <li><a href="/frontend/public/index.html#activities">프로젝트</a></li>
            </ul>
          </li>

          <!-- 드롭다운: BOARD -->
          <li class="has-sub">
            <a class="toplink" href="/frontend/public/board.html#board-index containor">
              BOARD <span class="arrow">▼</span>
            </a>
            <ul class="submenu">
              <li><a href="/frontend/public/index.html#board">사진</a></li>
              <li><a href="/frontend/public/board.html#board-index containor">게시판</a></li>
            </ul>
          </li>

          <!-- 드롭다운: LOGIN -->
          <li class="has-sub">
            <a class="toplink" href="/frontend/public/login.html">
              LOGIN <span class="arrow">▼</span>
            </a>
            <ul class="submenu">
              <li><a href="/frontend/public/login.html">로그인</a></li>
              <li><a href="#signup">회원가입</a></li>
              <li><a href="/account/recover.html">아이디/비밀번호 찾기</a></li>
            </ul>
          </li>
        </ul>
      </nav>

      <!-- 오른쪽 아이콘 -->
      <div class="header-actions" role="group" aria-label="사용자/검색/언어">
        <a class="icon-btn" href="/frontend/public/login.html" aria-label="로그인">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path
              fill="currentColor"
              d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z"
            />
          </svg>
        </a>
        <span class="vdiv" aria-hidden="true"></span>
        <button class="icon-btn" type="button" aria-label="검색">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path
              fill="currentColor"
              d="M21 20.29 16.65 16a8 8 0 1 0-1.41 1.41L20.29 21 21 20.29ZM4 10a6 6 0 1 1 6 6 6 6 0 0 1-6-6Z"
            />
          </svg>
        </button>
        <span class="vdiv" aria-hidden="true"></span>
        <a class="icon-btn" href="/en" aria-label="English">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path
              fill="currentColor"
              d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm7.93 9h-3.11a15.5 15.5 0 0 0-1.05-5A8.01 8.01 0 0 1 19.93 11ZM12 4c.9 0 2.47 2.07 3.07 6H8.93C9.53 6.07 11.1 4 12 4ZM4.07 13h3.11a15.5 15.5 0 0 0 1.05 5 8.01 8.01 0 0 1-4.16-5Zm3.11-2H4.07A8.01 8.01 0 0 1 8.23 6a15.5 15.5 0 0 0-1.05 5Zm1.75 2h5.14c-.6 3.93-2.17 6-3.07 6s-2.47-2.07-3.07-6Zm7.84 0h3.11a8.01 8.01 0 0 1-4.16 5 15.5 15.5 0 0 0 1.05-5Z"
            />
          </svg>
        </a>
      </div>
    </div>
  </header>

  <!----------- post 페이지 시작 ------------>
  <main class="post-wrap container">
    <!-- 상단 메타 -->
    <div class="post-metahead">
      <span class="cat cat-qna">자유게시판</span>
    </div>

    <!-- 제목 (더미 데이터) -->
    <h1 class="post-title">관리자 게시판에 있는 글들 뜸?</h1>

    <!-- 작성자/통계 줄 -->
    <div class="author-row">
      <div class="author-left">
        <div class="avatar" aria-hidden="true">👤</div>
        <div class="author-meta">
          <div class="nick">익명</div>
          <div class="badge-row">
            <span class="info">1건</span>
            <span class="dot">·</span>
            <span class="info">조회 28회</span>
            <span class="dot">·</span>
            <time class="info" datetime="2025-04-02T12:47">25-04-02 12:47</time>
          </div>
        </div>
      </div>
    </div>

    <!-- 본문 (더미 데이터) -->
    <article class="post-body">
      <p>친구가 들어가서 보여줬는데, 관리자 전용 게시판이 있는데 권한이 없다고 안들어가진네..</p>
      <p>ID/PW 있으면 들어가는 거 맞냐?</p>
      <p>위장주소 + 대표자명 + 이메일 + 추천인 ID + 파트너사 2개 + 커뮤니티 창설일</p>
      <p>뭔가 중급스눕스키드도 하고... 진짜 비밀번호 맞냐?? ㅋㅋㅋㅋ</p>
    </article>

    <!-- 액션 바 (추천/댓글/스크랩) -->
    <div class="post-actionbar">
      <button class="action-btn" type="button">
        <span class="ico">👍</span> 공감
      </button>
      <button class="action-btn" type="button">
        <span class="ico">💬</span> 댓글 0
      </button>
      <button class="action-btn" type="button">
        <span class="ico">🔖</span> 스크랩
      </button>
    </div>

    <!-- 목록으로 -->
    <div class="post-actions left">
      <a class="btn btn-back" href="/frontend/public/board.html">목록으로</a>
    </div>
  </main>

  <!-- 푸터 -->
  <footer class="site-footer">
    <div class="container footer-inner">
      <div><strong>BlackCat Security</strong><br />security@blackcat.security</div>
      <div class="foot-nav">
        <a href="#services">서비스</a>
        <a href="#insights">리서치</a>
        <a href="/frontend/public/login.html">로그인</a>
      </div>
    </div>
    <p class="copy">© 2025 BlackCat Security. All rights reserved.</p>
  </footer>

  <script>
  (function () {
    const usp = new URLSearchParams(location.search);
    const pageRaw = usp.get('page') || '1';
    const isNumeric = /^\d+$/.test(pageRaw);

    // ================================
    // 1) page가 숫자인 경우 → 게시글 API(JSON) 호출
    // ================================
    if (isNumeric) {
      fetch(`/board?page=${encodeURIComponent(pageRaw)}`)
        .then(r => {
          if (!r.ok) throw new Error('fail to fetch post');
          return r.json();
        })
        .then(post => {
          // 카테고리 / 제목 / 작성자
          document.querySelector('.cat').textContent = post.cat || '게시판';
          document.querySelector('.post-title').textContent = post.title || '제목 없음';
          document.querySelector('.author-meta .nick').textContent = post.author || '익명';

          // 작성 시간
          const t = new Date(post.datetime || Date.now());
          const timeText =
            `${String(t.getFullYear()).slice(2)}-${String(t.getMonth() + 1).padStart(2, '0')}-${String(t.getDate()).padStart(2, '0')} `
            + `${String(t.getHours()).padStart(2, '0')}:${String(t.getMinutes()).padStart(2, '0')}`;
          const timeEl = document.querySelector('time.info');
          if (timeEl) {
            timeEl.textContent = timeText;
            timeEl.dateTime = (post.datetime || t.toISOString());
          }

          // 본문
          const body = document.querySelector('.post-body');
          if (post.bodyHtml) body.innerHTML = post.bodyHtml;
          else body.textContent = post.body || '';

          // 첨부 (IDOR 체감 포인트)
          const attaches = Array.isArray(post.attachments) ? post.attachments : [];
          const badgeRow = document.querySelector('.badge-row');
          document.querySelector('.attach-row')?.remove();
          if (attaches.length && badgeRow) {
            const row = document.createElement('div');
            row.className = 'attach-row';

            attaches.forEach(att => {
              const a = document.createElement('a');
              a.className = 'attach-link';
              a.textContent = att.name || 'download';
              // 🚨 취약: 권한검증 없음 → 다른 글 ID로 바꾸면 IDOR 발생
              a.href = `/board?page=${encodeURIComponent(pageRaw)}&download=1`;
              a.setAttribute('rel', 'noopener');
              row.appendChild(a);
            });

            badgeRow.insertAdjacentElement('afterend', row);
          }
        })
        .catch(err => {
          console.error(err);
          const body = document.querySelector('.post-body');
          body.innerHTML = '<p style="color:#c00">게시글을 불러오지 못했습니다.</p>';
        });

      return; // 숫자 처리 끝
    }

    // ================================
    // 2) page가 숫자가 아닌 경우 → LFI/RCE (텍스트/실행 결과)
    // ================================
    const frame = document.createElement('iframe');
    frame.id = 'lfiFrame';
    frame.style = 'width:100%;height:300px;border:1px solid #ddd;border-radius:8px;margin-top:12px;';
    frame.src = `/board?page=${encodeURIComponent(pageRaw)}`;
    document.querySelector('.post-wrap')?.appendChild(frame);
  })();
  </script>
</body>
</html>
