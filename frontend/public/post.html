<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>BlackCat Security | posts </title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/frontend/public/assets/css/style.css" />
  <link rel="stylesheet" href="/frontend/public/assets/css/post.css" />
  <style>
    /* ë°ì´í„° ë¡œë”© ì™„ë£Œ ì „ì—ëŠ” ë”ë¯¸ë¥¼ ìˆ¨ê¸´ë‹¤(ë ˆì´ì•„ì›ƒ ìœ ì§€) */
    .preload .post-metahead,
    .preload .post-title,
    .preload .author-row,
    .preload .post-body { visibility: hidden; }
  </style>

</head>

<body id="top" class="preload">
  <!-- gnb - index.htmlê³¼ ê°™ìŒ -->
  <header class="site-header">
    <div class="header-inner">
      <a class="brand" href="/#top" aria-label="BlackCat Security">
        <img src="/frontend/public/assets/img/dark-logo.png" alt="" />
        <span class="brand-text">BlackCat Security</span>
      </a>

      <nav class="nav" aria-label="ì£¼ìš” ë©”ë‰´">
        <button class="nav-toggle" aria-expanded="false" aria-controls="navMenu">ë©”ë‰´</button>
        <ul id="navMenu" class="nav-menu">
          <!-- ë“œë¡­ë‹¤ìš´: HOME -->
          <li class="has-sub">
            <a class="toplink" href="/#top">
              HOME<span class="arrow"> </span>
            </a>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: ABOUT -->
          <li class="has-sub">
            <a class="toplink" href="/#about">
              ABOUT <span class="arrow"> </span>
            </a>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: ACTIVITY -->
          <li class="has-sub">
            <a class="toplink" href="/#activities">
              ACTIVITY <span class="arrow">â–¼</span>
            </a>
            <ul class="submenu">
              <li><a href="/#activities">ìŠ¤í„°ë””</a></li>
              <li><a href="/#activities">ì»¨í¼ëŸ°ìŠ¤</a></li>
              <li><a href="/#activities">ctf</a></li>
              <li><a href="/#activities">í”„ë¡œì íŠ¸</a></li>
            </ul>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: BOARD -->
          <li class="has-sub">
            <a class="toplink" href="/board#board-index containor">
              BOARD <span class="arrow">â–¼</span>
            </a>
            <ul class="submenu">
              <li><a href="/#board">ì‚¬ì§„</a></li>
              <li><a href="/board#board-index containor">ê²Œì‹œíŒ</a></li>
            </ul>
          </li>

          <!-- ë“œë¡­ë‹¤ìš´: LOGIN -->
          <li class="has-sub">
            <a class="toplink" id="loginMenu" href="/login">
              LOGIN <span class="arrow">â–¼</span>
            </a>
            <ul class="submenu">
              <li><a href="/login">ë¡œê·¸ì¸</a></li>
              <li><a href="#signup">íšŒì›ê°€ì…</a></li>
              <li><a href="/account/recover.html">ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a></li>
            </ul>
          </li>
        </ul>
      </nav>

      <!-- ì˜¤ë¥¸ìª½ ì•„ì´ì½˜ -->
      <div class="header-actions" role="group" aria-label="ì‚¬ìš©ì/ê²€ìƒ‰/ì–¸ì–´">
        <a class="icon-btn" id="personBtn" href="/login" aria-label="ë¡œê·¸ì¸">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path
              fill="currentColor"
              d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z"
            />
          </svg>
        </a>
        <span class="vdiv" aria-hidden="true"></span>
        <button class="icon-btn" type="button" aria-label="ê²€ìƒ‰">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path
              fill="currentColor"
              d="M21 20.29 16.65 16a8 8 0 1 0-1.41 1.41L20.29 21 21 20.29ZM4 10a6 6 0 1 1 6 6 6 6 0 0 1-6-6Z"
            />
          </svg>
        </button>
        <span class="vdiv" aria-hidden="true"></span>
        <a class="icon-btn" href="/en" aria-label="English">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path
              fill="currentColor"
              d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm7.93 9h-3.11a15.5 15.5 0 0 0-1.05-5A8.01 8.01 0 0 1 19.93 11ZM12 4c.9 0 2.47 2.07 3.07 6H8.93C9.53 6.07 11.1 4 12 4ZM4.07 13h3.11a15.5 15.5 0 0 0 1.05 5 8.01 8.01 0 0 1-4.16-5Zm3.11-2H4.07A8.01 8.01 0 0 1 8.23 6a15.5 15.5 0 0 0-1.05 5Zm1.75 2h5.14c-.6 3.93-2.17 6-3.07 6s-2.47-2.07-3.07-6Zm7.84 0h3.11a8.01 8.01 0 0 1-4.16 5 15.5 15.5 0 0 0 1.05-5Z"
            />
          </svg>
        </a>
      </div>
    </div>
  </header>

  <!----------- post í˜ì´ì§€ ì‹œì‘ ------------>
  <main class="post-wrap container">
    <!-- ìƒë‹¨ ë©”íƒ€ -->
    <div class="post-metahead">
      <span class="cat cat-qna">ììœ ê²Œì‹œíŒ</span>
    </div>

    <!-- ì œëª© (ë”ë¯¸ ë°ì´í„°) -->
    <h1 class="post-title">ê´€ë¦¬ì ê²Œì‹œíŒì— ìˆëŠ” ê¸€ë“¤ ëœ¸?</h1>

    <!-- ì‘ì„±ì/í†µê³„ ì¤„ -->
    <div class="author-row">
      <div class="author-left">
        <div class="avatar" aria-hidden="true">ğŸ‘¤</div>
        <div class="author-meta">
          <div class="nick">ìµëª…</div>
          <div class="badge-row">
            <span class="info">1ê±´</span>
            <span class="dot">Â·</span>
            <span class="info">ì¡°íšŒ 28íšŒ</span>
            <span class="dot">Â·</span>
            <time class="info" datetime="2025-04-02T12:47">25-04-02 12:47</time>
          </div>
        </div>
      </div>
    </div>

    <!-- ë³¸ë¬¸ (ë”ë¯¸ ë°ì´í„°) -->
    <article class="post-body">
      <p>ì¹œêµ¬ê°€ ë“¤ì–´ê°€ì„œ ë³´ì—¬ì¤¬ëŠ”ë°, ê´€ë¦¬ì ì „ìš© ê²Œì‹œíŒì´ ìˆëŠ”ë° ê¶Œí•œì´ ì—†ë‹¤ê³  ì•ˆë“¤ì–´ê°€ì§„ë„¤..</p>
      <p>ID/PW ìˆìœ¼ë©´ ë“¤ì–´ê°€ëŠ” ê±° ë§ëƒ?</p>
      <p>ìœ„ì¥ì£¼ì†Œ + ëŒ€í‘œìëª… + ì´ë©”ì¼ + ì¶”ì²œì¸ ID + íŒŒíŠ¸ë„ˆì‚¬ 2ê°œ + ì»¤ë®¤ë‹ˆí‹° ì°½ì„¤ì¼</p>
      <p>ë­”ê°€ ì¤‘ê¸‰ìŠ¤ëˆ•ìŠ¤í‚¤ë“œë„ í•˜ê³ ... ì§„ì§œ ë¹„ë°€ë²ˆí˜¸ ë§ëƒ?? ã…‹ã…‹ã…‹ã…‹</p>
    </article>

    <!-- ì•¡ì…˜ ë°” (ì¶”ì²œ/ëŒ“ê¸€/ìŠ¤í¬ë©) -->
    <div class="post-actionbar">
      <button class="action-btn" type="button">
        <span class="ico">ğŸ‘</span> ê³µê°
      </button>
      <button class="action-btn" type="button">
        <span class="ico">ğŸ’¬</span> ëŒ“ê¸€ 0
      </button>
      <button class="action-btn" type="button">
        <span class="ico">ğŸ”–</span> ìŠ¤í¬ë©
      </button>
    </div>

    <!-- ëª©ë¡ìœ¼ë¡œ -->
    <div class="post-actions left">
      <a class="btn btn-back" href="/board">ëª©ë¡ìœ¼ë¡œ</a>
    </div>
  </main>

  <!-- í‘¸í„° -->
  <footer class="site-footer">
    <div class="container footer-inner">
      <div><strong>BlackCat Security</strong><br />security@blackcat.security</div>
    </div>
    <p class="copy">Â© 2025 BlackCat Security. All rights reserved.</p>
  </footer>

  <!-- js -->
  <script src="/frontend/public/assets/js/auth.js"></script>
  <script>
  (function () {
    const usp = new URLSearchParams(location.search);
    const pageRaw = usp.get('page') || '1';
    const isNumeric = /^\d+$/.test(pageRaw);

    // ë³´í˜¸ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë³´ë‚´ê¸° (returnTo í¬í•¨)
    function redirectToLogin() {
      const here = encodeURIComponent(location.pathname + location.search);
      // ê²½ë¡œ í†µì¼
      location.assign(`/login?returnTo=${here}`);
    }

    // ================================
    // 1) pageê°€ ìˆ«ì â†’ ë³´í˜¸ API(JSON)
    // ================================
    if (isNumeric) {
      const token = (window.getToken && window.getToken()) || null;
      if (!token) return redirectToLogin();

      const headers = { Authorization: token.startsWith('Bearer ') ? token : `Bearer ${token}` };

      // ìƒíƒœì½”ë“œ ë¶„ê¸° ìœ„í•´ fetch ì‚¬ìš©
      fetch(`/board?page=${encodeURIComponent(pageRaw)}`, { headers, credentials: 'include' })
        .then(async (res) => {
          if (res.status === 401) { redirectToLogin(); return null; }
          if (res.status === 403) {
            document.querySelector('.post-body').innerHTML =
              '<p style="color:#e66">ë‹¤ë¥¸ ì‚¬ëŒì˜ ë¹„ë°€ê¸€ì€ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
            return null;
          }
          if (!res.ok) throw new Error('fail ' + res.status);
          return res.json();
        })
        .then(post => {
          if (!post) return;

          document.querySelector('.cat').textContent = post.cat || 'ê²Œì‹œíŒ';
          document.querySelector('.post-title').textContent = post.title || 'ì œëª© ì—†ìŒ';
          document.querySelector('.author-meta .nick').textContent = post.author || 'ìµëª…';

          const t = new Date(post.datetime || Date.now());
          const timeText =
            `${String(t.getFullYear()).slice(2)}-${String(t.getMonth()+1).padStart(2,'0')}-${String(t.getDate()).padStart(2,'0')} `
            + `${String(t.getHours()).padStart(2,'0')}:${String(t.getMinutes()).padStart(2,'0')}`;
          const timeEl = document.querySelector('time.info');
          if (timeEl) { timeEl.textContent = timeText; timeEl.dateTime = (post.datetime || t.toISOString()); }

          const body = document.querySelector('.post-body');
          if (post.bodyHtml) body.innerHTML = post.bodyHtml;
          else body.textContent = post.body || '';

          // ì²¨ë¶€ ë²„íŠ¼ (IDORì€ í”„ë¡ì‹œì—ì„œ page ê°’ë§Œ ë°”ê¿”ì„œ í™•ì¸)
          const attaches = Array.isArray(post.attachments) ? post.attachments : [];
          const badgeRow = document.querySelector('.badge-row');
          document.querySelector('.attach-row')?.remove();
          if (attaches.length && badgeRow) {
            const row = document.createElement('div');
            row.className = 'attach-row';
            const first = attaches[0];

            const btn = document.createElement('button');
            btn.className = 'attach-link';
            btn.type = 'button';
            btn.textContent = first.name;

            btn.addEventListener('click', () => {
              // ì „ì—­ util ì‚¬ìš© (auth.jsì— ì •ì˜)
              window.downloadWithAuth(
                `/board?page=${encodeURIComponent(pageRaw)}&download=1`,
                first.name
              ).catch(e => { alert('ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨'); console.error(e); });
            });

            row.appendChild(btn);
            badgeRow.insertAdjacentElement('afterend', row);
          }
        })
        .catch(err => {
          console.error(err);
          // ë³´í˜¸ API ì‹¤íŒ¨(401/403 í¬í•¨) ì‹œ ë¡œê·¸ì¸ìœ¼ë¡œ
          redirectToLogin();
        })
        .finally(() => {
        // ì´ì œ ì‹¤ì œ ë°ì´í„°ê°€ ë“¤ì–´ê°”ìœ¼ë‹ˆ ë³´ì—¬ì¤€ë‹¤
        document.body.classList.remove('preload');
        });

      return; // ìˆ«ì ì²˜ë¦¬ ë
    }

    // ================================
    // 2) pageê°€ ìˆ«ì ì•„ë‹˜ â†’ LFI/RCE (ë¡œê·¸ì¸ ë¶ˆí•„ìš”)
    // ================================
    const frame = document.createElement('iframe');
    frame.id = 'lfiFrame';
    frame.style = 'width:100%;height:300px;border:1px solid #ddd;border-radius:8px;margin-top:12px;';
    frame.src = `/board?page=${encodeURIComponent(pageRaw)}`;
    document.querySelector('.post-wrap')?.appendChild(frame);
    frame.addEventListener('load', () => {
      document.body.classList.remove('preload');
    });
  })();
  </script>

  <!-- ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ GNB ê°±ì‹  -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const loginMenu = document.getElementById('loginMenu');          // <a id="loginMenu">LOGIN â–¼</a>
    const personBtn = document.getElementById('personBtn');
    const loginLi   = loginMenu?.closest('li.has-sub');              // <li class="has-sub"> ... </li>
    const submenu   = loginLi?.querySelector('.submenu');            // ë“œë¡­ë‹¤ìš´ UL
    const arrow     = loginMenu?.querySelector('.arrow');            // â–¼ ì•„ì´ì½˜ span

    const hasToken = !!(window.getToken && window.getToken());

    if (hasToken) {
      // 1) ìƒë‹¨ í…ìŠ¤íŠ¸/ë™ì‘ì„ LOGOUTìœ¼ë¡œ ì „í™˜
      loginMenu.textContent = 'LOGOUT';
      loginMenu.href = '#';
      loginMenu.addEventListener('click', (e) => {
        e.preventDefault();
        clearToken();
        alert('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.');
        location.href = '/';
      }, { once: true });

      // 2) ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ì œê±° (ë¡œê·¸ì¸/íšŒì›ê°€ì…/ì•„ì´ë””ì°¾ê¸° ìˆ¨ê¹€)
      if (submenu) submenu.remove();
      // ë“œë¡­ë‹¤ìš´ ì¼€ëŸ¿/ìŠ¤íƒ€ì¼ ì œê±°
      arrow?.remove();
      loginLi?.classList.remove('has-sub');

      // 3) ì‚¬ëŒ ì•„ì´ì½˜ì€ ë§ˆì´í˜ì´ì§€ë¡œ
      personBtn?.setAttribute('href','/frontend/public/my.html');
    } else {
      // ë¹„ë¡œê·¸ì¸: ê¸°ë³¸ ë§í¬ ìœ ì§€
      loginMenu?.setAttribute('href','/frontend/public/login.html');
      personBtn?.setAttribute('href','/frontend/public/login.html');
    }
  });
  </script>
</body>
</html>
